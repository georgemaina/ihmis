/*
 * File: app/view/Payments.js
 *
 * This file was generated by Sencha Architect version 4.3.2.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 7.6.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 7.6.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('CarePortal.view.Payments', {
    extend: 'Ext.form.Panel',
    alias: 'widget.payments',

    requires: [
        'CarePortal.view.CashSalesViewModel4',
        'Ext.form.FieldSet',
        'Ext.form.field.ComboBox',
        'Ext.form.field.Date',
        'Ext.grid.Panel',
        'Ext.view.Table',
        'Ext.selection.RowModel',
        'Ext.grid.plugin.CellEditing',
        'Ext.grid.column.Column',
        'Ext.form.field.Number',
        'Ext.button.Button'
    ],

    viewModel: {
        type: 'payments'
    },
    height: 600,
    style: 'background-color: #d9f2e6;',
    layout: 'border',
    bodyPadding: '1 0 0 4',
    bodyStyle: 'background-color: #d9f2e6;',
    url: 'data/getDataFunctions.php?task=savePayments',

    items: [
        {
            xtype: 'container',
            region: 'center',
            items: [
                {
                    xtype: 'fieldset',
                    height: 184,
                    padding: 0,
                    style: 'background-color: #d9f2e6;',
                    layout: 'absolute',
                    items: [
                        {
                            xtype: 'combobox',
                            x: -46,
                            y: 40,
                            itemId: 'payMode',
                            width: 335,
                            fieldLabel: 'Payment Mode',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            labelWidth: 150,
                            name: 'payMode',
                            allowBlank: false,
                            emptyText: 'Select Payment mode',
                            displayField: 'Description',
                            minChars: 2,
                            queryMode: 'local',
                            store: [
                                'Cash',
                                'Mpesa',
                                'Both',
                                'Visa',
                                'Cheque'
                            ],
                            typeAhead: true,
                            valueField: 'ID'
                        },
                        {
                            xtype: 'textfield',
                            x: 525,
                            y: 5,
                            itemId: 'voucherNo',
                            fieldLabel: 'Voucher No',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            labelWidth: 130,
                            name: 'voucherNo',
                            fieldStyle: 'color:red; font-weight:bold;',
                            emptyText: 'Receipt Number'
                        },
                        {
                            xtype: 'textfield',
                            x: 525,
                            y: 75,
                            itemId: 'chequeNo',
                            fieldLabel: 'Cheque No',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            labelWidth: 130,
                            name: 'chequeNo',
                            fieldStyle: 'color:red; font-weight:bold;'
                        },
                        {
                            xtype: 'combobox',
                            x: 525,
                            y: 110,
                            itemId: 'department',
                            fieldLabel: 'Department',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            labelWidth: 130,
                            name: 'department',
                            fieldStyle: 'color:red; font-weight:bold;',
                            displayField: 'Description',
                            minChars: 2,
                            queryMode: 'local',
                            store: 'LocationsStore',
                            typeAhead: true,
                            valueField: 'ID'
                        },
                        {
                            xtype: 'textfield',
                            x: 525,
                            y: 145,
                            itemId: 'control',
                            fieldLabel: 'Control Amount',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            labelWidth: 130,
                            name: 'control',
                            fieldStyle: 'color:red; font-weight:bold;'
                        },
                        {
                            xtype: 'datefield',
                            x: 525,
                            y: 40,
                            itemId: 'paymentDate',
                            fieldLabel: 'Date',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            labelWidth: 130,
                            name: 'paymentDate',
                            fieldStyle: 'color:red; font-weight:bold;',
                            emptyText: 'Date'
                        },
                        {
                            xtype: 'textfield',
                            x: -27,
                            y: 110,
                            itemId: 'payee',
                            width: 475,
                            fieldLabel: 'Payee',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            labelWidth: 130,
                            name: 'payee'
                        },
                        {
                            xtype: 'textfield',
                            x: -26,
                            y: 145,
                            itemId: 'towards',
                            width: 475,
                            fieldLabel: 'Towards',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            labelWidth: 130,
                            name: 'towards'
                        },
                        {
                            xtype: 'combobox',
                            x: -45,
                            y: 75,
                            itemId: 'glAccount',
                            width: 495,
                            fieldLabel: 'GL Account',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            labelWidth: 150,
                            name: 'glAccount',
                            displayField: 'AccountName',
                            minChars: 2,
                            queryMode: 'local',
                            store: 'GeneralLedgerStore',
                            typeAhead: true,
                            valueField: 'AccountCode'
                        },
                        {
                            xtype: 'combobox',
                            x: 5,
                            y: 5,
                            itemId: 'cashPoint',
                            width: 285,
                            fieldLabel: 'Cash Point',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            name: 'cashPoint',
                            displayField: 'CashPoint',
                            minChars: 2,
                            queryMode: 'local',
                            store: 'CashPointsStore',
                            typeAhead: true,
                            valueField: 'CashPoint'
                        }
                    ]
                },
                {
                    xtype: 'gridpanel',
                    height: 203,
                    itemId: 'itemsGrid',
                    resizable: true,
                    columnLines: true,
                    store: 'LedgersStore',
                    selModel: {
                        selType: 'rowmodel'
                    },
                    plugins: [
                        {
                            ptype: 'cellediting',
                            clicksToEdit: 1
                        }
                    ],
                    columns: [
                        {
                            xtype: 'gridcolumn',
                            dataIndex: 'ledger',
                            text: 'Ledger'
                        },
                        {
                            xtype: 'gridcolumn',
                            dataIndex: 'code',
                            text: 'Code'
                        },
                        {
                            xtype: 'gridcolumn',
                            width: 290,
                            dataIndex: 'Name',
                            text: 'Name'
                        },
                        {
                            xtype: 'gridcolumn',
                            renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                var strSum=0;
                                store.getRange().forEach(function(rec) {
                                    // console.log(rec.get('unit_price'));
                                    strSum += rec.get('Amount');
                                    console.log(strSum);
                                } );
                                view.up('grid').up('panel').down('#total').setValue(strSum);

                            },
                            dataIndex: 'Amount',
                            text: 'Amount',
                            editor: {
                                xtype: 'numberfield',
                                minValue: 1
                            }
                        }
                    ]
                },
                {
                    xtype: 'fieldset',
                    height: 36,
                    margin: 0,
                    padding: 0,
                    style: 'background-color: #d9f2e6;',
                    layout: 'absolute',
                    items: [
                        {
                            xtype: 'button',
                            x: 175,
                            y: 0,
                            itemId: 'cmdSuppliers',
                            width: 145,
                            iconCls: 'x-fa fa-ellipsis-h',
                            text: 'Suppliers'
                        },
                        {
                            xtype: 'button',
                            x: 325,
                            y: 0,
                            itemId: 'cmdGLs',
                            width: 145,
                            iconCls: 'x-fa fa-ellipsis-h',
                            text: 'General Ledgers'
                        },
                        {
                            xtype: 'button',
                            x: 5,
                            y: -0.6666670000000181,
                            itemId: 'deleteSelectedItem',
                            style: 'background-color:red;',
                            width: 130,
                            iconCls: 'x-fa fa-trash',
                            text: 'Remove Item'
                        },
                        {
                            xtype: 'textfield',
                            x: 450,
                            y: 0,
                            itemId: 'total',
                            width: 225,
                            fieldLabel: 'Total',
                            labelAlign: 'right',
                            labelStyle: 'color:green; font-weight:bold;',
                            name: 'total'
                        }
                    ]
                },
                {
                    xtype: 'fieldset',
                    height: 46,
                    padding: 0,
                    style: 'background-color: #d9f2e6;',
                    layout: 'absolute',
                    items: [
                        {
                            xtype: 'button',
                            x: 550,
                            y: 5,
                            itemId: 'cmdSavePayment',
                            width: 120,
                            iconCls: 'x-fa fa-save',
                            text: 'Save'
                        },
                        {
                            xtype: 'button',
                            x: 225,
                            y: 5,
                            itemId: 'cmdOpenVouchers',
                            width: 215,
                            iconCls: 'x-fa fa-print',
                            text: 'Print Vouchers and Cheques'
                        },
                        {
                            xtype: 'button',
                            x: 810,
                            y: 5,
                            width: 135,
                            iconCls: 'x-fa fa-close',
                            text: 'Close'
                        }
                    ]
                }
            ]
        }
    ]

});